<!DOCTYPE html>
<html lang="en">
<head>
    <title>What's new for Maven users in Micronaut 2.2</title>
    <meta name="keywords" content="micronaut,jvm,framework,groovy,java,kotlin,microservices,graalvm,serverless" />
    <meta name="description" content="A modern, JVM-based, full-stack framework for building modular, easily testable microservice and serverless applications." />
    <meta name="date" content="November 23, 2020" />
    <meta name="robots" content="all"/>
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://micronaut.io/rss.xml" />
    <meta charset='utf-8'/>
    <link rel='icon' href='https://micronaut.io/images/favicon.ico'/>
    <meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'/>
    <meta name='twitter:card' content='summary_large_image'/>
    <meta name='twitter:site' content='@micronautfw'/>
    <meta name='twitter:description' content='A modern, JVM-based, full-stack framework for building modular, easily testable microservice and serverless applications.'/>
    <meta name='twitter:creator' content='@micronautfw'/>
    <meta property='og:image' content='https://micronaut.io/images/Micronaut_OG_Logo.png'/>
    <meta property='og:image:width' content='600'/>
    <meta property='og:image:height' content='300'/>
    <meta property='og:url' content='https://micronaut.io'/>
    <meta property='og:title' content='What's new for Maven users in Micronaut 2.2'/>
    <meta property='og:description' content='A modern, JVM-based, full-stack framework for building modular, easily testable microservice and serverless applications.'/>
    <meta property='og:type' content='website'/>
    <link rel='mask-icon' href='https://micronaut.io/images/website_icon.svg'/>
    <link rel='apple-touch-icon-precomposed' sizes='57x57' href='https://micronaut.io/images/apple-touch-icon-57x57.png'/>
    <link rel='apple-touch-icon-precomposed' sizes='114x114' href='https://micronaut.io/images/apple-touch-icon-114x114.png'/>
    <link rel='apple-touch-icon-precomposed' sizes='72x72' href='https://micronaut.io/images/apple-touch-icon-72x72.png'/>
    <link rel='apple-touch-icon-precomposed' sizes='144x144' href='https://micronaut.io/images/apple-touch-icon-144x144.png'/>
    <link rel='apple-touch-icon-precomposed' sizes='60x60' href='https://micronaut.io/images/apple-touch-icon-60x60.png'/>
    <link rel='apple-touch-icon-precomposed' sizes='120x120' href='https://micronaut.io/images/apple-touch-icon-120x120.png'/>
    <link rel='apple-touch-icon-precomposed' sizes='76x76' href='https://micronaut.io/images/apple-touch-icon-76x76.png'/>
    <link rel='apple-touch-icon-precomposed' sizes='152x152' href='https://micronaut.io/images/apple-touch-icon-152x152.png'/>
    <link rel='icon" type="image/png' href='https://micronaut.io/images/favicon-196x196.png' sizes='196x196'/>
    <link rel='con" type="image/png' href='https://micronaut.io/images/favicon-96x96.png' sizes='96x96'/>
    <link rel='icon" type="image/png' href='https://micronaut.io/images/favicon-32x32.png' sizes='32x32'/>
    <link rel='con" type="image/png' href='https://micronaut.io/images/favicon-16x16.png' sizes='16x16'/>
    <link rel='icon" type="image/png' href='https://micronaut.io/images/favicon-128.png' sizes='128x128'/>
    <meta name='application-name' content='&amp;nbsp;'/>
    <meta name='msapplication-TileColor' content='#FFFFFF'/>
    <meta name='msapplication-TileImage' content='https://micronaut.io/images/mstile-144x144.png'/>
    <meta name='msapplication-square70x70logo' content='https://micronaut.io/images/mstile-70x70.png'/>
    <meta name='msapplication-square150x150logo' content='https://micronaut.io/images/mstile-150x150.png'/>
    <meta name='msapplication-wide310x150logo' content='https://micronaut.io/images/mstile-310x150.png'/>
    <meta name='msapplication-square310x310logo' content='https://micronaut.io/images/mstile-310x310.png'/>
    <link rel='stylesheet' href='https://micronaut.io/stylesheets/screen.css'/>
    <script src='https://micronaut.io/javascripts/navbar_hide_scroll.js'></script>
    <script src='https://micronaut.io/javascripts/navigation.js'></script>
    <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/4547412.js"></script>
    

    <!--  CSS ASSETS  -->
    <link rel='stylesheet' href='/stylesheets/prismjs.css'/>
    <!--  JS OBJECTS  -->
    
    <!-- JAVASCRIPT ASSETS  -->
    <script src='/javascripts/prismjs.js'></script>
</head>
<body class='post'>
<div class='main'>
    <nav id='navbar'>
        <ul class='container'>
            <li class='align-right tiny'>
                <a href='#footercircle'>Menu</a>
            </li>
            <li class="align-right">
                <ul>
                    <li class='icon'>
                        <iframe src="https://ghbtns.com/github-btn.html?user=micronaut-projects&repo=micronaut-core&type=star&count=true" frameborder="0" scrolling="0" width="150" height="20" title="GitHub"></iframe>
                    </li>
                    <li><a href='https://micronaut.io/support.html'>Support</a></li>
                    <li><a href='https://micronaut.io/foundation/index.html'>Foundation</a></li>
                    <li><a href='https://micronaut.io/events.html'>Events</a></li>
                    <li><a href='https://micronaut.io/blog/index.html'>Blog</a></li>
                    <li><a href='https://micronaut.io/learn.html'>Learn</a></li>
                    <li><a href='https://micronaut.io/download.html'>Download</a></li>
                    <li><a href='https://micronaut.io/documentation.html'>Docs</a></li>
                    <li><a href='https://micronaut.io/launch/'>Launch</a></li>
                </ul>
            </li>
            <li class='large align-left'>
                <a href='https://micronaut.io/index.html'>
                    <img class='' src='https://micronaut.io/images/micronaut_mini_copy_tm.svg' alt='Micronaut Icon'/>
                </a>
            </li>
            <li class='small align-left'>
                <a href='https://micronaut.io/index.html'>
                    <img class='' src='https://micronaut.io/images/micronaut_mini.svg' alt='Micronaut Icon'/>
                </a>
            </li>
        </ul>
    </nav>
</div>
<article><div class='content container'>
  <h1>
    <a href='https://micronaut.io/blog/index.html'>
      <span>Micronaut<sup>&reg;</sup></span>
      <b>Blog</b>
    </a>
  </h1>
  <div class='light'>
    <div class='largegoldenratio align-left'>
      <div class='padded'><h1>What's new for Maven users in Micronaut 2.2</h1>
<p><span class="author">By Álvaro Sánchez-Mariscal</span></p>
<p><span class="date">November 23, 2020</span></p>
<p>Tags: <a href="https://micronaut.io/blog/tag/maven.html"><span class="hashtag">#maven</span></a> <a href="https://micronaut.io/blog/tag/docker.html"><span class="hashtag">#docker</span></a> <a href="https://micronaut.io/blog/tag/graalvm.html"><span class="hashtag">#graalvm</span></a></p>
<p>The Micronaut 2.2 release includes version 1.1 of the
<a href="https://github.com/micronaut-projects/micronaut-maven-plugin">Micronaut Maven Plugin</a>.
This new version of the Maven plugin includes the ability to package a Micronaut
application into different formats (fat JAR, native image, Docker, etc), generating
<code>Dockerfile</code>s, as well as pushing Docker images to different registries.</p>
<h2>mvn package all the things!</h2>
<p>There are already Maven plugins out there to produce Docker or native images,
and we could have just updated our documentation explaining how to use their
different goals. However, we thought we could do a better job, and starting with
Micronaut 2.2, <strong><code>mvn package</code></strong> is your one-stop shop for packaging your application
into different formats.</p>
<p>The way this works is via a custom lifecycle for the <code>package</code> phase in which we
cherry-pick what plugins/goals participate to produce the resulting artifact. Also,
where existing plugins didn't suffice, we implemented our own goals and added them
to the lifecycle so that <code>mvn package</code> just works for all cases. The configuration
of these plugins is defined in either the
<a href="https://search.maven.org/artifact/io.micronaut/micronaut-parent/2.2.0/pom">Micronaut Parent POM</a>,
or the application POM generated by <a href="https://launch.micronaut.io/">Micronaut Launch</a>.</p>
<p>To determine the packaging type, you use the <code>&lt;packaging&gt;</code> tag in your POM. By
default, it is defined as <code>&lt;packaging&gt;&#36;{packaging}&lt;/packaging&gt;</code>, with a property
named <code>packaging</code> set to <code>jar</code> by default. Therefore, <code>mvn package</code> will produce
a fat JAR by default, as it was the case before. The supported packaging types are:</p>
<ul>
<li><code>jar</code> (default): produces a runnable fat JAR.</li>
<li><code>native-image</code>: generates a GraalVM native image.</li>
<li><code>docker</code>: builds a Docker image with the application artifacts (compiled classes, resources, dependencies, etc).</li>
<li><code>docker-native</code>: builds a Docker image with a GraalVM native image inside.</li>
</ul>
<p>For example, to generate a GraalVM native image, you can simply run:</p>
<pre><code class="language-bash">&#36; ./mvnw package -Dpackaging=native-image
</code></pre>
<p>To build a Docker image, you can choose between <code>docker</code> and <code>docker-native</code>,
depending on whether the application is executed as either JVM or native image, respectively.
The Micronaut Maven Plugin uses internally
<a href="https://github.com/GoogleContainerTools/jib">Jib</a> where possible, or a
<a href="https://github.com/docker-java/docker-java">raw Docker client</a> otherwise,
to build the images.</p>
<p>Also, if you prefer, you can generate the equivalent <code>Dockerfile</code> and customise
it to your needs:</p>
<pre><code class="language-bash">&#36; ./mvnw mn:dockerfile -Dpackaging=docker-native
</code></pre>
<p>If you grab the generated <code>Dockerfile</code>, make the modifications you want, and place
it at the project's root, <code>mvn package</code> will use it for subsequent Docker builds.</p>
<p>Check the
<a href="https://micronaut-projects.github.io/micronaut-maven-plugin/latest/examples/package.html">Micronaut Maven Plugin packaging documentation</a>
for more information about the supported options.</p>
<h2>Pushing Docker images to Docker registries</h2>
<p>The Docker packaging options shown above will build and tag images to the local
Docker daemon. If you want to push them to remote registries, you can use
<strong><code>mvn deploy</code></strong>. The supported packaging types are:</p>
<ul>
<li><code>jar</code> (default): will deploy the JAR artifact to a remote repository delegating to
the <code>org.apache.maven.plugins:maven-deploy-plugin:deploy</code> goal, as it was the
case before.</li>
<li><code>docker</code> or <code>docker-native</code>: will push the Docker image to the configured Docker
registry by leveraging the Jib plugin configuration.</li>
</ul>
<p>For example, to push an image to Docker Hub:</p>
<pre><code class="language-xml">&lt;plugin&gt;
  &lt;groupId&gt;com.google.cloud.tools&lt;/groupId&gt;
  &lt;artifactId&gt;jib-maven-plugin&lt;/artifactId&gt;
  &lt;configuration&gt;
    &lt;to&gt;
      &lt;image&gt;docker.io/my-company/my-app:&#36;{project.version}&lt;/image&gt;
    &lt;/to&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre>
<p>Then, you can execute <code>mvn deploy -Dpackaging=docker</code> or
<code>mvn deploy -Dpackaging=docker-native</code>. The Micronaut Maven Plugin will do a
best-effort attempt to honour credentials defined at <code>~/.docker/config.json</code>,
as well as using
<a href="https://github.com/docker/docker-credential-helpers">credential helpers</a> such as
<code>docker-credential-gcr</code> for Google Cloud’s gcr.io and
<code>docker-credential-ecr-login</code> for Amazon’s ECR. Other credential helpers, or even
username/password authentication can be defined via the Jib plugin configuration.</p>
<p>Check the
<a href="https://micronaut-projects.github.io/micronaut-maven-plugin/latest/examples/deploy.html">Micronaut Maven Plugin deploy documentation</a>
for more information about the supported options.</p>
<h2>The future ahead</h2>
<p>This is just the beginning of new awesomeness that will land into the Micronaut
Maven Plugin. The next step is to move both the Maven and
<a href="https://github.com/micronaut-projects/micronaut-gradle-plugin/">Gradle</a> plugins
to the same Git repository and have them share code so that they have the same features.
We hope to have this ready by Micronaut 2.3.</p>
<p>In the meantime, feel free to report issues if you find them, or feature requests,
in the
<a href="https://github.com/micronaut-projects/micronaut-maven-plugin/issues">Micronaut Maven Plugin issue tracker</a>.
We hope you enjoy this new version!</p></div>
    </div>
    <div class='smallgoldenratio align-right padded-t related-posts'>
      <h2>You might also like ...</h2>
      <div><article class='blogcard' style='background-image: url(https://micronaut.io/images/2020-11-19.jpg)'>
  <a href='https://micronaut.io/blog/2020-11-19-micronaut-22-released.html'>
    <h3>November 19, 2020</h3>
    <h2>Micronaut 2.2 Released!</h2>
  </a>
</article><article class='blogcard' style='background-image: url(https://micronaut.io/images/2020-07-14.jpg)'>
  <a href='https://micronaut.io/blog/2020-07-14-micronaut-maven-support-micronaut2.html'>
    <h3>July 14, 2020</h3>
    <h2>Maven Support - Micronaut 2.0</h2>
  </a>
</article></div>
    </div>
  </div>
</div>&nbsp;</article>
<div id="footercircle" class="full whitecircleborderseparator"></div>
<footer>
    <div class='container'>
        <div class='mobile'>
            <nav id='footernav'>
                <ul class='container'>
                    <li><a href='https://micronaut.io/launch/'>Launch</a></li>
                    <li><a href='https://micronaut.io/documentation.html'>Docs</a></li>
                    <li><a href='https://micronaut.io/download.html'>Download</a></li>
                    <li><a href='https://micronaut.io/learn.html'>Learn</a></li>
                    <li><a href='https://micronaut.io/blog/index.html'>Blog</a></li>
                    <li><a href='https://micronaut.io/support.html'>Support</a></li>
                    <li><a href='https://micronaut.io/foundation/index.html'>Foundation</a></li>
                    <li><a href='https://micronaut.io/events.html'>Events</a></li>
                    <li><a href='https://micronaut.io/blog/index.html'>Blog</a></li>
                </ul>
            </nav>
        </div>
        <p id='blacklogo'>
            <img src='https://micronaut.io/images/micronautlogo.svg' alt='Micronaut Logo'/>
        </p>
        <div class='twocolumns'>
            <div class='column'>
                <nav id='socialnetworknav'>
                    <ul class='container'>
                        <li>
                            <a href='https://gitter.im/micronautfw/'>
                                <img class='socialicon' src='https://micronaut.io/images/gitter.svg' alt='Gitter Icon'/>
                            </a>
                        </li>
                        <li>
                            <a href='https://www.youtube.com/playlist?list=PLI74De5M9T72YshO4Sc90wtGr286nM8Yu'>
                                <img class='socialicon' src='https://micronaut.io/images/youtube.svg' alt='Youtube Icon'/>
                            </a>
                        </li>
                        <li>
                            <a href='https://github.com/micronaut-projects/'>
                                <img class='socialicon' src='https://micronaut.io/images/github.svg' alt='Github Icon'/>
                            </a>
                        </li>
                        <li>
                            <a href='https://twitter.com/micronautfw'>
                                <img class='socialicon' src='https://micronaut.io/images/twitter.svg' alt='Twitter Icon'/>
                            </a>
                        </li>
                        <li>
                            <a href='mailto:info@micronaut.io?subject=Micronaut&amp;amp;body=I%20am%20interested%20in%20Micronaut.'>
                                <img class='socialicon' src='https://micronaut.io/images/mail.svg' alt='Mail Icon'/>
                            </a>
                        </li>
                        <li>
                            <a href='https://micronaut.io/rss.xml'>
                                <img class='socialicon' src='https://micronaut.io/images/rss_social.svg' alt='RSS Feed Icon'/>
                            </a>
                        </li>
                    </ul>
                </nav>
                <p>
                    <small>© 2021, Object Computing, Inc. (OCI). All rights reserved</small>
                </p>
            </div>
            <div class='column' style='margin-top: 10px;'>
                <p>
                    <a title='Visit OCI Website' href='https://objectcomputing.com'>
                        <img src='https://micronaut.io/images/oci_logo.svg' alt='Object Computing' style='max-width: 300px'/>
                    </a>
                </p>
            </div>
        </div>
    </div>
</footer>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115754405-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-115754405-1');
</script>
<script type="text/javascript">
    adroll_adv_id = "J4NA4XCFDNFHDGNFUAVMQD";
    adroll_pix_id = "J4XYMNCOQNBCXJJ4GP744N";

    (function() {
        var _onload = function() {
            if (document.readyState && !/loaded|complete/.test(document.readyState)) {
                setTimeout(_onload, 10);
                return
            }
            if (!window.__adroll_loaded) {
                __adroll_loaded = true;
                setTimeout(_onload, 50);
                return
            }
            var scr = document.createElement("script");
            var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
            scr.setAttribute('async', 'true');
            scr.type = "text/javascript";
            scr.src = host + "/j/roundtrip.js";
            ((document.getElementsByTagName('head') || [null])[0] ||
                document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
        };
        if (window.addEventListener) {
            window.addEventListener('load', _onload, false);
        }
        else {
            window.attachEvent('onload', _onload)
        }
    }());
</script>
</body>
</html>
